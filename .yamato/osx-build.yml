name: "Mac - Build SPIRV-Cross"
agent:
    type: Unity::VM::osx
    image: slough-ops/macos-10.14-xcode:latest
    flavor: b1.small

commands: 
        - brew install cmake
        - brew install ninja
        - |
            export CC=`xcrun -find cc`
            export CXX=`xcrun -find c++`
            cd ../
            cmake -HSPIRV-Cross -BSPIRV-Cross/_builds -DSPIRV_CROSS_STATIC=ON -DSPIRV_CROSS_SHARED=ON
            cd SPIRV-Cross
            cmake --build _builds --config Release
        - |
            mkdir spirv-cross
            cp "_builds/libspirv-cross-c-shared.dylib" spirv-cross
artifacts:
    builds:
      paths:
        - "spirv-cross/**"
